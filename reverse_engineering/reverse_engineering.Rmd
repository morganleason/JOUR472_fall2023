---
title: "Reverse Engineering Project"
author: "Morgan Leason"
date: "10/16/23"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

In this notebook, we are reverse engineering the story, Inside The Political Donation History Of Wealthy Sports Owners (<https://fivethirtyeight.com/features/inside-the-political-donation-history-of-wealthy-sports-owners/>)

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
options(scipen=999)

library(tidyverse)
library(readr)
library(janitor)
library(lubridate)
```

## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary for data you are working with, and discuss any caveats or issues you discovered working with this data.

```{r}
# Load required data

# Path to data should be loaded from folder "data" i.e. read_csv("data/name_of_data.csv")

# Clean required data and prepare for analysis if needed.

sports_donation <- read_csv("data/sports-political-donations.csv") |>
  mutate(Amount = str_replace_all(Amount,'\\$','')) |>
  mutate(Amount = str_replace_all(Amount, '\\,','')) |>
  mutate(Amount = as.numeric(Amount))

```

## Sentences to Engineer

In this notebook, we are reverse engineering five sentences from the story.

### 1: "Of the 160 owners and commissioners in ESPN's database, 74 contributed a majority of their publicly searchable funds to Republican campaigns, with 48 donating a majority to Democrats and the rest sending most of their money to causes that aren't fully aligned with either party." 

### Who provided the highest number of donations? 

A: Charles Johnson. Johnson had 213 total donations.

```{r}
# Put code to reverse engineer sentence here

sports_donation |>
  group_by(Owner) |>
  summarise(total_donations = n()) |>
  arrange(desc(total_donations))

# Display results of code below this codeblock

```

### 2: "Drilling down deeper into the data, we can see that federal contributions in each league lean red, except for in the WNBA." 

### Which league gave the most individual donations? A: MLB, which gave 746 donations, well above the rest.

```{r}
# Put code to reverse engineer sentence here
sports_donation |>
  group_by(League) |>
  summarise(total_donation = n()) |>
  arrange(desc(total_donation))
# Display results of code below this codeblock

```

### 3: "Expanding to all the leagues in our research, here are their totals to each party over the six-year period." 

### How many donations for the top party? 

A: The top party that received the most donations was the Democratic Party. These results were slightly unclear because the top listing was "Bipartisan," which indicates that some of the donations were tareting something other than the party such as donations for passing a specific bill.

```{r}
# Put code to reverse engineer sentence here
sports_donation |> 
  group_by(Party) |>
  summarise(n()) 
# Display results of code below this codeblock

```

### 4: "There are 40 owners who have donated at least \$100,000 to Republican causes over the six-year period, compared to 23 owners topping \$100,000 to Democrats, helping lead to these splits." 

### Which year had the most number of donations? 

A: The election year 2018 had the most number of donations.

```{r}
# Put code to reverse engineer sentence here
sports_donation |>
  group_by(`Election Year`) |>
  summarise(count_per_year = n()) |>
  arrange(desc(count_per_year))
# Display results of code below this codeblock

```
